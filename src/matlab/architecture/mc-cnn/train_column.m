function net = train_column(train_imds,test_imds,layers)
%TRAIN_COLUMN Train a column of the mc-cnn.
%   
%   net = TRAIN_COLUMN(train_imds,test_imds,layers) Train a column,
%   described by layers, of the mc-cnn. This routine centralizes the
%   trainingOptions. train_imds is the imds used for training, test_imds is
%   the imds used for validation/testing. No cross validation is intrinsically 
%   provided here.
%
%   See also trainNetwork, trainingOptions

    options = trainingOptions('sgdm', ...
    'LearnRateSchedule','piecewise', ...
    'InitialLearnRate',0.05,...
    'LearnRateDropFactor',0.5,...
    'LearnRateDropPeriod',20,...
    'MaxEpochs',10, ...
    'MiniBatchSize',64, ...
    'Shuffle','every-epoch',...
    'Verbose',true,...
    'VerboseFrequency',1,...
    'ExecutionEnvironment', 'parallel',...
    'DispatchInBackground', true);
    %   'Plots','training-progress'
    %   'ValidationFrequency',4
    %   'ValidationData',test_imds
    
    net = trainNetwork(train_imds, layers, options);
end

