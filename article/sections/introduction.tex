\section{Introduction}
    \par{
        A fundamental aim in any industry is to design highly efficient and effective quality control processes. Therefore, the research area focusing on automatic defect detection systems has become even more fecund in the last decades. 
    }
    \par{
        There is a large variety of previous work on defect detection on steel surfaces. Many ideas \cite{ieee:4777721, ieee:7030439, ieee:8623728} bank on the uniformity of the background surface, while other solutions use deep learning architectures \cite{ieee:1334512, ieee:6738559}, which provide an attempt to a robust defect segmentation. More refined approaches rely on wavelets to detect abrupt changes on the surfaces \cite{ieee:993164, ieee:6703333, ieee:7155940, sciencedirect:NGAN2011442}. The core of the architecture proposed in this paper is based on wavelet analysis and on deep learning, due to two main reasons.
    }
    \par{
        Firstly, multi-resolution analysis (MRA) based on wavelets has been proven effective in facing localization in both spatial and in frequency domains \cite{Vetterli:1995:WSC:201007, Daubechies:1992:TLW:130655, intechopen:bernardini}. This because of their mathematical properties, compared to Fourier's transform.
    }
    \par{
        Secondly, in the last years deep learning \cite{Goodfellow:2016:DL:3086952, Rojas:1996:NNS:235222} has outperformed any human-designed classificator. Indeed computer vision and image processing are increasing in popularity in many fields, from autonomous driving vehicles to retail security. Hence, there has been an appreciable improvement in the effectiveness of defect detection based on visual systems and a lot of work has been done since the rise of deep learning applications \cite{researchgate:deeplearning}.
    }
    \par{
        Three main computer vision tasks can be outlined: classification, object localization and object detection.
    }
    \par{
        The classification task faces the supervised learning problem of identifying to which of a set of categories a given object belongs to. In computer vision this means assigning one of the available labels to an image. This is the simplest of the three tasks and recognizing the category of the principal object in a picture is the standard application of Convolutional Neural Network (CNN), from handwritten characters \cite{nips:NIPS1989_293, ieee:6248110} and house numbers \cite{ieee:6460867} to traffic signs \cite{ieee:6248110}.

    }
    \par{
        The main reason why CNNs have become so popular since LeCun originally introduced them \cite{nips:NIPS1989_293, ieee:726791, LeCun:1999:ORG:646469.691875, researchgate:deeplearning} is that they represent a black box from raw pixels to categories labels, therefore they overcome the difficulties intrinsic in designing tailored features extractors. Morover, they are also more likely to be shift and scale invariant \cite{LeCun:1999:ORG:646469.691875}, and they have been proven to have enviable classification accuracies.
    }
    \par{
        A classification task in defect detection field is accounted when objects, e.g. steel surfaces, need to be binary classified as defective or flawless. In monitoring applications, classifying pictures as a whole would be expensive, since local screening hardware would be needed. Patently, a global visual system is far more appetible. 
    }
    \par{
        Moreover, a local analysis may miss some global features of a particular defect; this is the case of burst defects, such as zipper cracks \cite{defects:mainlinemetals}.
    }
    \par{
        Object localization sights to find a given number of items in a given context, predicting both their position and their class. Object detection removes the constraint on the number of items, allowing either zero or any finite number of objects, not fixed \emph{a priori}. In computer vision, in particular in 2D images, the position is described by a bounding box.
    }
    \par{
        CNNs have been used along with sliding window and multiscale approaches for object detection \cite{ieee:7410526, ieee:7532516, arXiv:1312.6229S}, and there is a lot of work aiming to improve performances and bounding boxes accuracies, either by designing different neural network architectures \cite{ieee:7410526} or by tailoring existing one \cite{ieee:726791}.
    }
    \par{
        In this paper a further refined system is presented, since the purpose of the defect detection algorithm is not only to globally mark an image as picturing a flawless or defective steel surface, but both to highlight flawed regions within the image and to label them as belonging to a particular defect class.
    }
    \par{
        Pixel-wide classification is known in literature as image segmentation, and there are three main families of tecniques: hysteretic thresholding, edge-based and region-based \cite{ieee:7684170}. Thresholding exploits a previously known function defined over the pixels space and classifies pixels through comparison with some discrete values (thresholds) \cite{ieee:4310039}, but it is tipically used within other tecniques rather then alone. Region-based approaches use graph algorithms \cite{ieee:6205760, ieee:868688} or watersheds analogies \cite{ieee:87344}. Edge-based tecniques, instead, use an edge detection filter \cite{Klette:2014:CCV:2584519, googlescholar:kovesiphase, researchgate:phase}, along with denoising and thresholding considerations, to solve the boundary detection problem. Remark that although similar, boundary detection aims to describe changes in pixel ownerwhip from one object or surface to another, whereas an edge is an abrupt change, which can be a sub-domain of a border. There are also more advanced tecniques \cite{springer:Kass1988} boundary-related which rely on energy minimization and are embedded on region-based approaches. Indeed, all these tecniques can be mixed both together and with learning algorithms, either unsupervised \cite{ieee:7684170} or supervised \cite{ieee:1273918}.
    }
    \par{
        The approach here described merges the more effective and efficient ideas of previously described work, balancing the drawbacks of different tecniques. Since segmentation is needed, an edge-based contour detector is presented here, to reach high speed segmentation. Wavelet are used along with image preprocessing and alpha-shape \cite{springer:10.1007/11907350_46} to identify proposals, i.e. regions of interest for the classificator, which may contain a defective area. To overcome the bias introduced from hand-crafting the edge-detection filter, the hyperparameters of the algorithm are tuned with Bayesian Optimization \cite{arXiv:2018arXiv180702811F, arXiv:2012arXiv1206.2944S, rasmussen:williams:2006}.
        A multi-column CNN (MC-CNN) \cite{ieee:6248110} is then used to combine the segmentation information with a well-known classificator architecture, exploiting both local information and global information. The proposed architecture is shown to have optimal performances on the \emph{Severstal: Steel Defect Detection} Kaggle competition dataset \cite{kaggle:severstal}.
    }